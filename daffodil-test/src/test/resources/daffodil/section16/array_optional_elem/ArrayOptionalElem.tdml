<?xml version="1.0" encoding="UTF-8"?>
<tdml:testSuite suiteName="Array-OptionalElemTests"
  description="Section 16 - Arrays and Optional Elements" xmlns:tdml="http://www.ibm.com/xmlns/dfdl/testData"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dfdl="http://www.ogf.org/dfdl/dfdl-1.0/"
  xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:ct="http://w3.ibm.com/xmlns/dfdl/ctInfoset"
  xmlns:ex="http://example.com">

  <tdml:defineSchema name="array-optionalElem.dfdl.xsd">

    <dfdl:format lengthKind="delimited" lengthUnits="bytes"
      encoding="UTF-8" separator="" initiator="" terminator=""
      occursCountKind="parsed" ignoreCase="no" textNumberRep="standard"
      representation="text" />

    <xs:element name="root">
      <xs:complexType>
        <xs:sequence dfdl:separator=","
          dfdl:separatorPosition="infix" dfdl:separatorPolicy="suppressed">
          <xs:element name="e1" type="xs:int" minOccurs="0" />
          <xs:element name="e2" type="xs:float" minOccurs="0" />
          <xs:element name="e3" type="xs:unsignedByte"
            minOccurs="0" />
        </xs:sequence>
      </xs:complexType>
    </xs:element>

  </tdml:defineSchema>

  <tdml:parserTestCase name="optionalElem" root="root"
    model="array-optionalElem.dfdl.xsd"
    description="Section 16 - a sequence of optional elements, no data is consumed - DFDL-16-001R">

    <tdml:document><![CDATA[abcde,127.9,-109]]></tdml:document>

    <tdml:errors>
      <tdml:error />
    </tdml:errors>

  </tdml:parserTestCase>
  
  <tdml:defineSchema name="arrays1">

    <dfdl:format ref="ex:daffodilTest1" occursCountKind="implicit"
      lengthKind="delimited" separatorPolicy="suppressedAtEndStrict"
      separatorPosition="prefix" />

    <xs:element name="r">
      <xs:complexType>
        <xs:sequence dfdl:separator="$">
          <xs:element name="a" type="xs:string" minOccurs="0"
            dfdl:initiator="a:" dfdl:terminator=";" />
          <xs:element name="b" type="xs:string"
            dfdl:terminator=";" />
        </xs:sequence>
      </xs:complexType>
    </xs:element>

  </tdml:defineSchema>

  <tdml:parserTestCase name="optionalWithSeparators"
    model="arrays1" root="r" description="Section 16 - an optional element applied to a local element - DFDL-16-001R">
    <tdml:document><![CDATA[$x;]]></tdml:document>
    <tdml:infoset>
      <tdml:dfdlInfoset>
        <r>
          <b>x</b>
        </r>
      </tdml:dfdlInfoset>
    </tdml:infoset>
  </tdml:parserTestCase>

</tdml:testSuite>
